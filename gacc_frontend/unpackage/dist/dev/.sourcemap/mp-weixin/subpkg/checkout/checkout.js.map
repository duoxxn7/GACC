{"version":3,"sources":["uni-app:///main.js","webpack:///D:/miniprogramdevelop/program/gacc/subpkg/checkout/checkout.vue?beef","webpack:///D:/miniprogramdevelop/program/gacc/subpkg/checkout/checkout.vue?c0e3","webpack:///D:/miniprogramdevelop/program/gacc/subpkg/checkout/checkout.vue?032c","webpack:///D:/miniprogramdevelop/program/gacc/subpkg/checkout/checkout.vue?32d2","uni-app:///subpkg/checkout/checkout.vue","webpack:///D:/miniprogramdevelop/program/gacc/subpkg/checkout/checkout.vue?64e8","webpack:///D:/miniprogramdevelop/program/gacc/subpkg/checkout/checkout.vue?cbf1"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","items","paymentMethods","name","value","icon","selectedMethod","orderData","transactionData","computed","totalAmount","selectedMethodName","onLoad","methods","generateOrderData","item","OrderID","ItemID","Quantity","OrderAmount","OrderTime","TransactionID","PaymentMethod","TransactionTime","paymentMethodChange","confirmPayment","uni","title","content","success","processPayment","orderRes","transactionRes","url","console","createOrders","method","BuyerID","Orders","res","response","message","createTransactions","reason","transactionStatus","Transactions","TransactionStatus","updateOrdersStatus","OrderIDs","OrderStatus","clearPurchasedItems","itemIDs","cancelPayment","editable","placeholderText","submitCancelReason","delta"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,iBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiI;AACjI;AAC4D;AACL;AACqC;;;AAG5F;AACmK;AACnK,gBAAgB,6KAAU;AAC1B,EAAE,8EAAM;AACR,EAAE,+FAAM;AACR,EAAE,wGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,mGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAqmB,CAAgB,knBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eCoDznB;EACAC;IACA;MACAC;MAAA;MACAC;QACAC;QACAC;QACAC;MACA,GACA;QACAF;QACAC;QACAC;MACA,GACA;QACAF;QACAC;QACAC;MACA,EACA;MACAC;MAAA;MACAC;MAAA;MACAC;IACA;EACA;;EACAC;IACA;IACAC;MACA;QACA;MACA;IACA;IACA;IACAC;MAAA;MACA;QAAA;MAAA;MACA;IACA;EACA;EACAC;IACA;IACA;MACA;IACA;EACA;EACAC;IACA;IACAC;MAAA;MACA;MACA;;MAEA;QACA;QACA,2CACAC,wBACAA;QAEA;UACAC;UACAC;UAAA;UACAC;UACAC;UACAC;QACA;MACA;MAEA;QACA,2CACAL,wBACAA;QAEA;UACAM;UACAL;UACAM;UACAC;QACA;MACA;IACA;IAEA;IACAC;MACA;IACA;IAEA;IACAC;MAAA;MACAC;QACAC;QACAC;QACAC;UACA;YACA;UACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAC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","file":"subpkg/checkout/checkout.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './subpkg/checkout/checkout.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./checkout.vue?vue&type=template&id=77a7cfba&scoped=true&\"\nvar renderjs\nimport script from \"./checkout.vue?vue&type=script&lang=js&\"\nexport * from \"./checkout.vue?vue&type=script&lang=js&\"\nimport style0 from \"./checkout.vue?vue&type=style&index=0&id=77a7cfba&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"77a7cfba\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"subpkg/checkout/checkout.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./checkout.vue?vue&type=template&id=77a7cfba&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./checkout.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./checkout.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"checkout-container\">\r\n    <!-- 顶部标题 -->\r\n    <view class=\"header\">\r\n      <text class=\"title\">订单结算</text>\r\n    </view>\r\n\r\n    <!-- 商品列表 -->\r\n    <scroll-view scroll-y class=\"items-container\">\r\n      <view v-for=\"item in items\" :key=\"item.ItemID\" class=\"item-card\">\r\n        <image :src=\"item.ItemImage\" class=\"item-image\" />\r\n        <view class=\"item-info\">\r\n          <text class=\"item-name\">{{ item.ItemName }}</text>\r\n          <text class=\"game-name\">{{ item.GameName }}</text>\r\n          <view class=\"price-section\">\r\n            <text class=\"price\">¥{{ item.Price }}</text>\r\n            <text class=\"quantity\">x{{ item.Quantity }}</text>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </scroll-view>\r\n\r\n    <!-- 订单总金额 -->\r\n    <view class=\"total-section\">\r\n      <text class=\"total-label\">订单总金额:</text>\r\n      <text class=\"total-amount\">¥{{ totalAmount }}</text>\r\n    </view>\r\n\r\n    <!-- 支付方式选择 -->\r\n    <view class=\"payment-methods\">\r\n      <text class=\"section-title\">选择支付方式</text>\r\n      <radio-group @change=\"paymentMethodChange\">\r\n        <label class=\"method-item\" v-for=\"method in paymentMethods\" :key=\"method.value\">\r\n          <view class=\"method-left\">\r\n            <image :src=\"method.icon\" class=\"method-icon\" />\r\n            <text class=\"method-name\">{{ method.name }}</text>\r\n          </view>\r\n          <radio :value=\"method.value\" :checked=\"selectedMethod === method.value\" color=\"#1989fa\" />\r\n        </label>\r\n      </radio-group>\r\n    </view>\r\n\r\n    <!-- 底部支付按钮 -->\r\n    <view class=\"footer\">\r\n      <button class=\"pay-button\" @click=\"confirmPayment\" :disabled=\"!selectedMethod\">\r\n        确认支付 ¥{{ totalAmount }}\r\n      </button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        items: [], // 从购物车传递过来的商品\r\n        paymentMethods: [{\r\n            name: '微信支付',\r\n            value: 'wechat',\r\n            icon: '/static/payment/wechat.png'\r\n          },\r\n          {\r\n            name: '支付宝',\r\n            value: 'alipay',\r\n            icon: '/static/payment/alipay.png'\r\n          },\r\n          {\r\n            name: '余额支付',\r\n            value: 'balance',\r\n            icon: '/static/payment/balance.png'\r\n          }\r\n        ],\r\n        selectedMethod: '', // 当前选中的支付方式\r\n        orderData: [], // 存储生成的订单数据\r\n        transactionData: [] // 存储生成的交易数据\r\n      }\r\n    },\r\n    computed: {\r\n      // 计算订单总金额\r\n      totalAmount() {\r\n        return this.items.reduce((total, item) => {\r\n          return total + (item.Price * item.Quantity)\r\n        }, 0).toFixed(2)\r\n      },\r\n      // 获取选中的支付方式名称\r\n      selectedMethodName() {\r\n        const method = this.paymentMethods.find(m => m.value === this.selectedMethod)\r\n        return method ? method.name : ''\r\n      }\r\n    },\r\n    onLoad(options) {\r\n      // 从购物车页面接收传递的商品数据\r\n      if (options.items) {\r\n        this.items = JSON.parse(decodeURIComponent(options.items))\r\n      }\r\n    },\r\n    methods: {\r\n      // 生成订单和交易数据\r\n      generateOrderData() {\r\n        const timestamp = Date.now().toString(36) /* .slice(-6) */ ; // 时间戳取6位\r\n        const randomStr = Math.random().toString(36).substr(2, 4); // 随机数取4位\r\n\r\n        this.orderData = this.items.map(item => {\r\n          // 截取ItemID后8位（如果长度>8），否则保留原ID\r\n          const shortItemID = item.ItemID.length > 8 ?\r\n            item.ItemID.slice(-8) :\r\n            item.ItemID;\r\n\r\n          return {\r\n            OrderID: `ORD_${timestamp}_${randomStr}_${shortItemID}`,\r\n            ItemID: item.ItemID, // 原始ID保持不变\r\n            Quantity: item.Quantity,\r\n            OrderAmount: (item.Price * item.Quantity).toFixed(2),\r\n            OrderTime: new Date().toISOString()\r\n          }\r\n        });\r\n\r\n        this.transactionData = this.items.map(item => {\r\n          const shortItemID = item.ItemID.length > 8 ?\r\n            item.ItemID.slice(-8) :\r\n            item.ItemID;\r\n\r\n          return {\r\n            TransactionID: `TRX_${timestamp}_${randomStr}_${shortItemID}`,\r\n            OrderID: `ORD_${timestamp}_${randomStr}_${shortItemID}`,\r\n            PaymentMethod: this.selectedMethod,\r\n            TransactionTime: new Date().toISOString()\r\n          }\r\n        });\r\n      },\r\n\r\n      // 支付方式选择变化\r\n      paymentMethodChange(e) {\r\n        this.selectedMethod = e.detail.value\r\n      },\r\n\r\n      // 确认支付按钮点击\r\n      confirmPayment() {\r\n        uni.showModal({\r\n          title: '确认支付',\r\n          content: `确认使用${this.selectedMethodName}支付 ¥${this.totalAmount} 吗？`,\r\n          success: (res) => {\r\n            if (res.confirm) {\r\n              this.processPayment()\r\n            } else if (res.cancel) {\r\n              this.cancelPayment()\r\n            }\r\n          }\r\n        })\r\n      },\r\n\r\n      // 处理支付逻辑\r\n      async processPayment() {\r\n        uni.showLoading({\r\n          title: '支付处理中...'\r\n        })\r\n\r\n        try {\r\n          // 1. 生成订单数据\r\n          this.generateOrderData()\r\n          // 2. 批量创建订单\r\n          const orderRes = await this.createOrders()\r\n          if (!orderRes.success) {\r\n            throw new Error(orderRes.message || '创建订单失败')\r\n          }\r\n          // 3. 批量创建交易记录（支付成功）\r\n          const transactionRes = await this.createTransactions('成功')\r\n          if (!transactionRes.success) {\r\n            throw new Error(transactionRes.message || '创建交易记录失败')\r\n          }\r\n          // 4. 清空购物车中已购买的商品\r\n          await this.clearPurchasedItems()\r\n          uni.hideLoading()\r\n          // 支付成功跳转到购物车列表页\r\n          uni.switchTab({\r\n            url: '/pages/cart/cart'\r\n          })\r\n          uni.showToast({\r\n            title: '支付成功',\r\n            icon: 'success'\r\n          })\r\n        } catch (err) {\r\n          uni.hideLoading()\r\n          console.error('支付出错:', err)\r\n          // 如果订单创建成功但交易失败，需要更新订单状态\r\n          if (this.orderData.length > 0) {\r\n            await this.updateOrdersStatus('支付失败')\r\n          }\r\n          uni.showToast({\r\n            title: err.message || '支付失败',\r\n            icon: 'none'\r\n          })\r\n        }\r\n      },\r\n\r\n      // 批量创建订单\r\n      async createOrders() {\r\n        try {\r\n          const res = await uni.request({\r\n            url: 'http://localhost:3000/orders/batch',\r\n            method: 'POST',\r\n            data: {\r\n              BuyerID: this.$globalData.userID,\r\n              Orders: this.orderData,\r\n              PaymentMethod: this.selectedMethod\r\n            }\r\n          })\r\n          const response = Array.isArray(res) ? res[1].data : res.data\r\n          return response\r\n        } catch (err) {\r\n          console.error('创建订单出错:', err)\r\n          return {\r\n            success: false,\r\n            message: '创建订单失败'\r\n          }\r\n        }\r\n      },\r\n\r\n      // 批量创建交易记录\r\n      async createTransactions(status, reason = '') {\r\n        try {\r\n          const transactionStatus = status === '成功' ? '成功' : `失败: ${reason}`.substring(0, 50);\r\n\r\n          const res = await uni.request({\r\n            url: 'http://localhost:3000/transactions/batch',\r\n            method: 'POST',\r\n            data: {\r\n              Transactions: this.transactionData.map(trx => ({\r\n                TransactionID: String(trx.TransactionID).substring(0, 50),\r\n                OrderID: String(trx.OrderID).substring(0, 50),\r\n                PaymentMethod: String(trx.PaymentMethod).substring(0, 20),\r\n                TransactionTime: new Date(trx.TransactionTime || new Date()).toISOString(),\r\n                TransactionStatus: transactionStatus\r\n              }))\r\n            }\r\n          });\r\n\r\n          if (!res.data.success) {\r\n            throw new Error(res.data.message || '创建交易记录失败');\r\n          }\r\n          return res.data;\r\n        } catch (err) {\r\n          console.error('创建交易记录出错:', err);\r\n          throw err;\r\n        }\r\n      },\r\n      // 批量更新订单状态\r\n      async updateOrdersStatus(status) {\r\n        try {\r\n          await uni.request({\r\n            url: 'http://localhost:3000/orders/batch/status',\r\n            method: 'PUT',\r\n            data: {\r\n              OrderIDs: this.orderData.map(order => order.OrderID),\r\n              OrderStatus: status\r\n            }\r\n          })\r\n        } catch (err) {\r\n          console.error('更新订单状态出错:', err)\r\n        }\r\n      },\r\n      // 清空购物车中已购买的商品\r\n      async clearPurchasedItems() {\r\n        try {\r\n          const itemIDs = this.items.map(item => item.ItemID)\r\n\r\n          await uni.request({\r\n            url: `http://localhost:3000/cart/clear-purchased/${this.$globalData.userID}`,\r\n            method: 'POST',\r\n            data: {\r\n              itemIDs: itemIDs\r\n            }\r\n          })\r\n        } catch (err) {\r\n          console.error('清空购物车商品出错:', err)\r\n        }\r\n      },\r\n\r\n      // 取消支付\r\n      cancelPayment() {\r\n        uni.showModal({\r\n          title: '取消支付',\r\n          content: '请输入取消支付的原因',\r\n          editable: true,\r\n          placeholderText: '请输入取消原因',\r\n          success: (res) => {\r\n            if (res.confirm && res.content) {\r\n              this.submitCancelReason(res.content)\r\n            }\r\n          }\r\n        })\r\n      },\r\n\r\n      // 提交取消支付原因\r\n      async submitCancelReason(reason) {\r\n        if (!reason) {\r\n          uni.showToast({\r\n            title: '请填写取消原因',\r\n            icon: 'none'\r\n          })\r\n          return\r\n        }\r\n        uni.showLoading({\r\n          title: '处理中...'\r\n        })\r\n        try {\r\n          // 1. 生成订单数据\r\n          this.generateOrderData()\r\n          // 2. 批量创建订单\r\n          const orderRes = await this.createOrders()\r\n          if (!orderRes.success) {\r\n            throw new Error(orderRes.message || '创建订单失败')\r\n          }\r\n          // 3. 批量创建交易记录（失败状态）\r\n          const transactionRes = await this.createTransactions('失败', reason)\r\n          if (!transactionRes.success) {\r\n            throw new Error(transactionRes.message || '创建交易记录失败')\r\n          }\r\n          // 4. 更新订单状态为已取消\r\n          await this.updateOrdersStatus('已取消')\r\n          uni.hideLoading()\r\n          // 返回购物车页面\r\n          uni.navigateBack({\r\n            delta: 1\r\n          })\r\n          uni.showToast({\r\n            title: '已取消支付',\r\n            icon: 'none'\r\n          })\r\n        } catch (err) {\r\n          uni.hideLoading()\r\n          console.error('取消支付出错:', err)\r\n          uni.showToast({\r\n            title: err.message || '取消支付失败',\r\n            icon: 'none'\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  .checkout-container {\r\n    padding: 20rpx;\r\n    padding-bottom: 120rpx;\r\n    min-height: 100vh;\r\n    background-color: #f7f7f7;\r\n  }\r\n\r\n  .header {\r\n    padding: 30rpx 0;\r\n    text-align: center;\r\n    border-bottom: 1rpx solid #eee;\r\n    margin-bottom: 20rpx;\r\n  }\r\n\r\n  .title {\r\n    font-size: 36rpx;\r\n    font-weight: bold;\r\n  }\r\n\r\n  .items-container {\r\n    max-height: 40vh;\r\n    margin-bottom: 20rpx;\r\n    background-color: #fff;\r\n    border-radius: 12rpx;\r\n    padding: 20rpx;\r\n  }\r\n\r\n  .item-card {\r\n    display: flex;\r\n    margin-bottom: 30rpx;\r\n    padding-bottom: 20rpx;\r\n    border-bottom: 1rpx solid #f5f5f5;\r\n  }\r\n\r\n  .item-card:last-child {\r\n    margin-bottom: 0;\r\n    padding-bottom: 0;\r\n    border-bottom: none;\r\n  }\r\n\r\n  .item-image {\r\n    width: 160rpx;\r\n    height: 160rpx;\r\n    border-radius: 8rpx;\r\n    margin-right: 20rpx;\r\n  }\r\n\r\n  .item-info {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n  }\r\n\r\n  .item-name {\r\n    font-size: 30rpx;\r\n    color: #333;\r\n    font-weight: bold;\r\n    margin-bottom: 10rpx;\r\n  }\r\n\r\n  .game-name {\r\n    font-size: 26rpx;\r\n    color: #999;\r\n    margin-bottom: 20rpx;\r\n  }\r\n\r\n  .price-section {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n  }\r\n\r\n  .price {\r\n    font-size: 32rpx;\r\n    color: #e64340;\r\n    font-weight: bold;\r\n  }\r\n\r\n  .quantity {\r\n    font-size: 28rpx;\r\n    color: #999;\r\n  }\r\n\r\n  .total-section {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    align-items: center;\r\n    padding: 20rpx;\r\n    background-color: #fff;\r\n    border-radius: 12rpx;\r\n    margin-bottom: 20rpx;\r\n  }\r\n\r\n  .total-label {\r\n    font-size: 28rpx;\r\n    color: #666;\r\n    margin-right: 15rpx;\r\n  }\r\n\r\n  .total-amount {\r\n    font-size: 36rpx;\r\n    color: #e64340;\r\n    font-weight: bold;\r\n  }\r\n\r\n  .payment-methods {\r\n    background-color: #fff;\r\n    border-radius: 12rpx;\r\n    padding: 20rpx;\r\n  }\r\n\r\n  .section-title {\r\n    display: block;\r\n    font-size: 28rpx;\r\n    color: #666;\r\n    margin-bottom: 20rpx;\r\n  }\r\n\r\n  .method-item {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    padding: 20rpx 0;\r\n    border-bottom: 1rpx solid #f5f5f5;\r\n  }\r\n\r\n  .method-item:last-child {\r\n    border-bottom: none;\r\n  }\r\n\r\n  .method-left {\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n\r\n  .method-icon {\r\n    width: 50rpx;\r\n    height: 50rpx;\r\n    margin-right: 20rpx;\r\n  }\r\n\r\n  .method-name {\r\n    font-size: 30rpx;\r\n    color: #333;\r\n  }\r\n\r\n  .footer {\r\n    position: fixed;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    padding: 20rpx;\r\n    background-color: #fff;\r\n    box-shadow: 0 -4rpx 12rpx rgba(0, 0, 0, 0.08);\r\n  }\r\n\r\n  .pay-button {\r\n    height: 90rpx;\r\n    line-height: 90rpx;\r\n    background-color: #1989fa;\r\n    color: white;\r\n    border-radius: 45rpx;\r\n    font-size: 32rpx;\r\n  }\r\n\r\n  .pay-button[disabled] {\r\n    background-color: #c8c9cc;\r\n  }\r\n</style>","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./checkout.vue?vue&type=style&index=0&id=77a7cfba&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./checkout.vue?vue&type=style&index=0&id=77a7cfba&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1750234746068\n      var cssReload = require(\"D:/miniprogramdevelop/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}